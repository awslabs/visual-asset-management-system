{
    "comments": "Configuration for VAMS v2.3 to v2.4 complete migration (Constraints + Metadata + Reindex)",

    "_comment_phase1_4": "Phase 1-4: Constraints table migration - DynamoDB table names (required)",
    "auth_entities_table_name": "YOUR-AuthEntitiesTable-NAME",
    "constraints_table_name": "YOUR-ConstraintsStorageTable-NAME",

    "_comment_phase5": "Phase 5: Metadata table migration (AssetFiles) - DynamoDB table names (required)",
    "old_metadata_table_name": "YOUR-OLD-MetadataStorageTable-NAME",
    "new_metadata_table_name": "YOUR-AssetFileMetadataStorageTable-NAME",

    "_comment_phase5_5": "Phase 5.5: Metadata schema migration - DynamoDB table names (required)",
    "old_metadata_schema_table_name": "YOUR-OLD-MetadataSchemaTable-NAME",
    "new_metadata_schema_table_name": "YOUR-MetadataSchemaStorageTableV2-NAME",

    "_comment_phase6": "Phase 6: OpenSearch reindexing - Lambda function name (required)",
    "reindexer_function_name": "YOUR-ReindexerFunction-rOsReindexer-NAME",
    "clear_indexes_before_reindex": false,

    "_comment_operation": "Migration operation settings",
    "delete_old_data": false,
    "dry_run": false,
    "limit": null,

    "_comment_aws": "AWS configuration (optional)",
    "aws_profile": null,
    "aws_region": null,

    "_comment_logging": "Logging settings",
    "log_level": "INFO",

    "_comment_instructions": "How to use this configuration file",
    "_instructions": [
        "=== SETUP ===",
        "1. Get table and function names from CloudFormation stack outputs:",
        "   aws cloudformation describe-stacks --stack-name your-vams-stack \\",
        "     --query 'Stacks[0].Outputs[?contains(OutputKey, `Table`) || contains(OutputKey, `Function`)].{Key:OutputKey,Value:OutputValue}' \\",
        "     --output table",
        "",
        "2. Update configuration with actual resource names:",
        "   - auth_entities_table_name: Source table for constraints (Phase 1-4)",
        "   - constraints_table_name: Target table for constraints (Phase 1-4)",
        "   - old_metadata_table_name: Source table for metadata (Phase 5)",
        "   - new_metadata_table_name: Target table for metadata (Phase 5)",
        "   - old_metadata_schema_table_name: Source table for metadata schemas (Phase 5.5)",
        "   - new_metadata_schema_table_name: Target table for metadata schemas (Phase 5.5)",
        "   - reindexer_function_name: Lambda function for OpenSearch reindex (Phase 6)",
        "",
        "=== EXECUTION ===",
        "3. Run dry-run first (HIGHLY RECOMMENDED):",
        "   python v2.3_to_v2.4_migration.py --config v2.3_to_v2.4_migration_config.json --dry-run",
        "",
        "4. Test with limited items (optional):",
        "   python v2.3_to_v2.4_migration.py --config v2.3_to_v2.4_migration_config.json --limit 10 --dry-run",
        "",
        "5. Run production migration (keeps old data for safety):",
        "   python v2.3_to_v2.4_migration.py --config v2.3_to_v2.4_migration_config.json",
        "",
        "6. Optional: Delete old data after verification:",
        "   python v2.3_to_v2.4_migration.py --config v2.3_to_v2.4_migration_config.json --delete-old-data",
        "",
        "=== MIGRATION PHASES ===",
        "Phase 1-4: Constraints Migration",
        "  - Migrates constraints from AuthEntitiesTable to ConstraintsStorageTable",
        "  - Transforms to denormalized format with GSI support",
        "  - Idempotent: Safe to re-run",
        "",
        "Phase 5: Metadata Migration",
        "  - Migrates metadata from old single-record format to new individual-field format",
        "  - Handles both asset metadata (filePath='/') and file metadata",
        "  - Parses assetId to distinguish assets from files",
        "  - Idempotent: Safe to re-run",
        "",
        "Phase 5.5: Metadata Schema Migration",
        "  - Migrates metadata schemas from field-per-record to schema-per-database format",
        "  - Groups fields by databaseId and creates one 'migratedSchema' per database",
        "  - Transforms field types (textarea→multiline_string, location→lla, etc.)",
        "  - Skips controlled-list fields without values",
        "  - Deletes existing 'migratedSchema' before migration to avoid duplicates",
        "  - Idempotent: Safe to re-run",
        "",
        "Phase 6: OpenSearch Reindexing",
        "  - Invokes reindexer Lambda to update OpenSearch indexes",
        "  - Reindexes both assets and files",
        "  - Optional: Clear indexes before reindexing",
        "",
        "=== SAFETY FEATURES ===",
        "- dry_run: Test without making changes (default: false)",
        "- limit: Test with subset of items per table (default: null = all items)",
        "- delete_old_data: Delete from source tables after migration (default: false)",
        "- clear_indexes_before_reindex: Clear OpenSearch indexes before reindex (default: false)",
        "- Idempotent operations: Safe to re-run if migration fails",
        "- Duplicate detection: Skips already-migrated items",
        "",
        "=== NOTES ===",
        "- Command-line arguments override config file settings",
        "- All phases run in sequence (1-4, 5, 5.5, 6)",
        "- Migration continues even if one phase has no data",
        "- Reindex only runs if not in dry-run mode",
        "- Old data kept by default for safety - delete manually after verification"
    ]
}
